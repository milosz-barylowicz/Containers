name: create-release

on:
  workflow_dispatch:
    inputs:
      release-number:
        description: 'Release number'
        required: true
      release-title:
        description: 'Release title'
        required: false

env:
  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

jobs:
  create-release:
    runs-on: [ ubuntu-22.04 ]

    steps:
      - uses: actions/checkout@v4.1.1

      - name: setting-up-git
        uses: de-vri-es/setup-git-credentials@v2.1.2
        with:
          credentials: ${{ secrets.GITHUB_TOKEN }}

      - name: creating-release-branch
        run: ./.github/workflows/scripts/create-release-branch.sh ${{ inputs.release-number }}

      - name: creating-release
        if: inputs.release-title == ''
        run: |
          gh release create v${{ inputs.release-number }} --title "v${{ inputs.release-number }}" --generate-notes

      - name: creating-release-with-title
        if: inputs.release-title != ''
        run: |
          gh release create v${{ inputs.release-number }} --title "v${{ inputs.release-number }}: ${{ inputs.release-title }}" --generate-notes
